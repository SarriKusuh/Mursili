<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fizzy Star</title>
    <link rel="icon" type="image/png" href="Favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #E6FEFE;
            color: #f0f0f0;
            /* overflow-x-hidden is important to prevent horizontal scrollbars */
            overflow-x: hidden;
        }

        .sidebar {
            /* Keep the sidebar off-screen by default */
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            z-index: 50;
        }

        .sidebar.open {
            /* Move it into view when the 'open' class is present */
            transform: translateX(0);
        }

        .menu-link {
            transition: color 0.2s;
        }

        .menu-link.active {
            color: #E2E833;
        }

        /* CSS for the universe background using a local image file */
        .header-bg {
            background-image: url('Stonehaven-sky.jpg');
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .header-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 41, 59, 0.4); /* Subtle dark overlay */
        }

        /* Backdrop to close the menu on mobile/tablet */
        .backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 40;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        .backdrop.visible {
            opacity: 1;
            visibility: visible;
        }

    </style>
</head>
<body>

    <div id="main-content" class="min-h-screen flex flex-col">

        <header class="p-4 shadow-lg flex items-center justify-between bg-gray-900 header-bg">
            <div class="flex items-center gap-2">
                <h1 class="text-xl sm:text-2xl font-bold text-[#E2E833]">Fizzy Star</h1>
                <svg class="w-6 h-6 text-[#E2E833]" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 .587l3.668 7.568 8.332 1.151-6.064 5.828 1.512 8.356-7.448-3.902-7.449 3.902 1.512-8.356-6.064-5.828 8.332-1.151z"/>
                </svg>
            </div>
            <button id="menu-button" class="text-white focus:outline-none p-2 z-50">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                </svg>
            </button>
        </header>

        <div id="sidebar" class="fixed top-0 left-0 h-full w-64 bg-gray-800 shadow-xl sidebar">
            <div class="p-4">
                <h2 class="text-2xl font-bold text-white mb-6 pt-4">Menu</h2>
                <nav>
                    <ul class="space-y-4">
                        <li><a href="#accueil" class="menu-link text-lg block py-2 px-4 rounded-lg hover:bg-gray-700 active">Accueil</a></li>
                        <li><a href="#livres-sur-la-foi" class="menu-link text-lg block py-2 px-4 rounded-lg hover:bg-gray-700">Livres sur la foi</a></li>
                        <li><a href="#autres-livres" class="menu-link text-lg block py-2 px-4 rounded-lg hover:bg-gray-700">Autres Livres</a></li>
                        <li><a href="#podcasts" class="menu-link text-lg block py-2 px-4 rounded-lg hover:bg-gray-700">Podcasts</a></li>
                        <li><a href="#articles" class="menu-link text-lg block py-2 px-4 rounded-lg hover:bg-gray-700">Articles</a></li>
                        <li><a href="#contact" class="menu-link text-lg block py-2 px-4 rounded-lg hover:bg-gray-700">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>

        <main class="flex-grow p-6 sm:p-8 space-y-12 z-10">

            <section id="accueil" class="content-section">
                <div class="bg-gray-800 rounded-2xl p-6 sm:p-8 shadow-lg">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-[#E2E833] mb-4">Accueil</h2>
                    <p class="text-gray-300 leading-relaxed text-sm sm:text-base">Bienvenue sur notre blog. Ici, Nous partagons nos passions pour la foi en Jésus, la lecture, les podcasts inspirants et les articles de fond. Nous espèrons que vous trouverez ici de quoi vous divertir et vous enrichir.</p>
                </div>
            </section>

            <section id="livres-sur-la-foi" class="content-section hidden">
                <div class="bg-gray-800 rounded-2xl p-6 sm:p-8 shadow-lg">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-[#E2E833] mb-4">Livres sur la foi</h2>
                    <div id="livres-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
                </div>
            </section>

            <section id="autres-livres" class="content-section hidden">
                <div class="bg-gray-800 rounded-2xl p-6 sm:p-8 shadow-lg">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-[#E2E833] mb-4">Autres Livres</h2>
                    <div id="autres-livres-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    </div>
                </div>
            </section>

            <section id="podcasts" class="content-section hidden">
                <div class="bg-gray-800 rounded-2xl p-6 sm:p-8 shadow-lg">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-[#E2E833] mb-4">Podcasts</h2>
                    <div class="grid grid-cols-1 gap-6">
                        <div class="bg-gray-700 rounded-xl overflow-hidden shadow-lg">
                            <div class="w-full h-[400px]">
                                <iframe class="w-full h-full" src="https://www.youtube.com/embed/EulBGprDanY" title="AstroTalk: A Journey to the Stars" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            </div>
                        </div>

                        <div class="bg-gray-700 rounded-xl overflow-hidden shadow-lg">
                            <div class="w-full h-[400px]">
                                <iframe class="w-full h-full" src="https://www.youtube.com/embed/GQOouuBIG-A" title="Cosmic Perspectives" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            </div>
                        </div>

                        <div class="bg-gray-700 rounded-xl overflow-hidden shadow-lg">
                            <div class="w-full h-[400px]">
                                <iframe class="w-full h-full" src="https://www.youtube.com/embed/kmLSqzT-D3M" title="The Universe Explained" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="articles" class="content-section hidden">
                <div class="bg-gray-800 rounded-2xl p-6 sm:p-8 shadow-lg">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-[#E2E833] mb-4">Articles</h2>
                    <div id="articles-list" class="space-y-4">
                        </div>
                </div>
            </section>
            
            <section id="contact" class="content-section hidden">
                <div class="bg-gray-800 rounded-2xl p-6 sm:p-8 shadow-lg">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-[#E2E833] mb-4">Contact</h2>
                    <p class="text-gray-300 leading-relaxed text-sm sm:text-base">Vous pouvez nous écrire à fizzystar13@gmail.com</p>
                </div>
            </section>

        </main>
    </div>

    <div id="backdrop" class="backdrop"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const menuButton = document.getElementById('menu-button');
            const sidebar = document.getElementById('sidebar');
            const backdrop = document.getElementById('backdrop');
            const menuLinks = document.querySelectorAll('.menu-link');
            const contentSections = document.querySelectorAll('.content-section');
            
            let booksDataFetched = false; // A flag to prevent multiple fetches
            let otherBooksDataFetched = false; // A flag for other books data
            let articlesDataFetched = false; // Flag for articles data

            // Function to close the menu
            const closeMenu = () => {
                sidebar.classList.remove('open');
                backdrop.classList.remove('visible');
            };

            // Function to load the books data
            const loadBooks = () => {
                if (booksDataFetched) {
                    return; // Do nothing if data is already fetched
                }
                
                fetch('output-livres-foi.json')
                    .then(response => response.json())
                    .then(data => {
                        const container = document.getElementById('livres-grid');
                        container.innerHTML = ''; // Clear previous content if any

                        // Loop through each item in the JSON data
                        data.forEach(livre => {
                            const card = document.createElement('div');
                            // Ensure the card uses flex-col and justify-between to push the price/buy to the bottom
                            card.className = "p-4 border-2 border-[#E2E833] rounded-xl flex flex-col items-center text-center";
                            
                            // Create and set the image
                            const image = document.createElement('img');
                            image.src = `livres/${livre.Image}`;
                            image.alt = livre.Titre;
                            image.className = "w-full h-auto rounded-lg mb-2";

                            // Create and set the title
                            const titre = document.createElement('h3');
                            titre.className = "text-xl font-bold text-white mb-2";
                            titre.textContent = livre.Titre;

                            // Create and set the description
                            const description = document.createElement('p');
                            description.className = "text-gray-300 text-sm flex-grow";
                            description.textContent = livre.Description;
                            
                            // Container for Price and Buy Button (to be displayed inline)
                            const priceBuyContainer = document.createElement('div');
                            // Use flexbox to align price and button horizontally
                            priceBuyContainer.className = "flex items-center justify-center mt-4 w-full space-x-4";

                            // Create and set the price
                            const prix = document.createElement('p');
                            // Keep the font bold and large
                            prix.className = "text-xl font-bold text-white";
                            prix.textContent = `${livre.Prix} €`;

                            // NEW: Create the Buy button
                            const buyButton = document.createElement('a');
                            // Set the link target from the 'Buy' field in the JSON
                            buyButton.href = livre.Buy || "#"; // Use '#' if Buy field is missing
                            buyButton.target = "_blank"; // Open in a new tab
                            buyButton.className = "px-3 py-1 text-sm font-semibold text-gray-800 bg-[#E2E833] rounded-full shadow hover:bg-yellow-300 transition-colors duration-200";
                            buyButton.textContent = "Acheter";

                            // Append price and button to their container
                            priceBuyContainer.appendChild(prix);
                            priceBuyContainer.appendChild(buyButton);

                            // Append the elements to the card
                            card.appendChild(image);
                            card.appendChild(titre);
                            card.appendChild(description);
                            // Append the container with price and buy button
                            card.appendChild(priceBuyContainer);

                            // Append the finished card to the main container
                            container.appendChild(card);
                        });
                        booksDataFetched = true;
                    })
                    .catch(error => console.error('Erreur lors du chargement du fichier JSON:', error));
            };

            // Function to load the other books data
            const loadOtherBooks = () => {
                if (otherBooksDataFetched) {
                    return; // Do nothing if data is already fetched
                }
                
                fetch('output-autres-livres.json')
                    .then(response => response.json())
                    .then(data => {
                        const container = document.getElementById('autres-livres-grid');
                        container.innerHTML = ''; // Clear previous content if any

                        // Loop through each item in the JSON data
                        data.forEach(livre => {
                            const card = document.createElement('div');
                            // Ensure the card uses flex-col and justify-between to push the price/buy to the bottom
                            card.className = "p-4 border-2 border-[#E2E833] rounded-xl flex flex-col items-center text-center";
                            
                            // Create and set the image
                            const image = document.createElement('img');
                            image.src = `livres/${livre.Image}`;
                            image.alt = livre.Titre;
                            image.className = "w-full h-auto rounded-lg mb-2";

                            // Create and set the title
                            const titre = document.createElement('h3');
                            titre.className = "text-xl font-bold text-white mb-2";
                            titre.textContent = livre.Titre;

                            // Create and set the description
                            const description = document.createElement('p');
                            description.className = "text-gray-300 text-sm flex-grow";
                            description.textContent = livre.Description;
                            
                            // Container for Price and Buy Button (to be displayed inline)
                            const priceBuyContainer = document.createElement('div');
                            // Use flexbox to align price and button horizontally
                            priceBuyContainer.className = "flex items-center justify-center mt-4 w-full space-x-4";

                            // Create and set the price
                            const prix = document.createElement('p');
                            // Keep the font bold and large
                            prix.className = "text-xl font-bold text-white";
                            prix.textContent = `${livre.Prix} €`;

                            // NEW: Create the Buy button
                            const buyButton = document.createElement('a');
                            // Set the link target from the 'Buy' field in the JSON
                            buyButton.href = livre.Buy || "#"; // Use '#' if Buy field is missing
                            buyButton.target = "_blank"; // Open in a new tab
                            buyButton.className = "px-3 py-1 text-sm font-semibold text-gray-800 bg-[#E2E833] rounded-full shadow hover:bg-yellow-300 transition-colors duration-200";
                            buyButton.textContent = "Acheter";

                            // Append price and button to their container
                            priceBuyContainer.appendChild(prix);
                            priceBuyContainer.appendChild(buyButton);

                            // Append the elements to the card
                            card.appendChild(image);
                            card.appendChild(titre);
                            card.appendChild(description);
                            // Append the container with price and buy button
                            card.appendChild(priceBuyContainer);

                            // Append the finished card to the main container
                            container.appendChild(card);
                        });
                        otherBooksDataFetched = true;
                    })
                    .catch(error => console.error('Erreur lors du chargement du fichier JSON (autres livres):', error));
            };

            // Function to load the articles data
            const loadArticles = () => {
                if (articlesDataFetched) {
                    return; // Do nothing if data is already fetched
                }
                
                fetch('output-articles.json')
                    .then(response => response.json())
                    .then(data => {
                        const container = document.getElementById('articles-list');
                        container.innerHTML = ''; // Clear previous content if any

                        // Loop through each item in the JSON data
                        data.forEach(article => {
                            const articleDiv = document.createElement('div');
                            articleDiv.className = "bg-gray-700 rounded-xl p-4 shadow-md space-y-2";
                            
                            // Get the encoded filename for the link
                            const encodedFilename = encodeURIComponent(article.filename);
                            const fullPath = `articles/${encodedFilename}`;
                            
                            // 1. Title link
                            const titleLink = document.createElement('a');
                            titleLink.href = fullPath; 
                            titleLink.target = "_blank"; // Opens in a new tab
                            titleLink.className = "text-white text-lg hover:text-[#E2E833] transition-colors duration-200 font-semibold block";
                            titleLink.textContent = article.Titre; 
                            
                            // 2. Description paragraph
                            const descriptionP = document.createElement('p');
                            descriptionP.className = "text-gray-300 text-sm";
                            descriptionP.textContent = article.Description; 

                            // 3. Date span (with conversion)
                            const dateSpan = document.createElement('span');
                            dateSpan.className = "text-gray-400 text-sm block"; 
                            
                            // Conversion de la date (timestamp en millisecondes)
                            const timestamp = parseInt(article.Date, 10);
                            if (!isNaN(timestamp)) {
                                const articleDate = new Date(timestamp);
                                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                                dateSpan.textContent = articleDate.toLocaleDateString('fr-FR', options);
                            } else {
                                dateSpan.textContent = article.Date; 
                            }

                            // Assemble article div in the desired order (Title -> Description -> Date)
                            articleDiv.appendChild(titleLink);
                            articleDiv.appendChild(descriptionP);
                            articleDiv.appendChild(dateSpan);

                            // Append the finished article div to the main container
                            container.appendChild(articleDiv);
                        });
                        articlesDataFetched = true;
                    })
                    .catch(error => console.error('Erreur lors du chargement du fichier JSON (articles):', error));
            };
            
            // Toggle the sidebar and backdrop visibility
            menuButton.addEventListener('click', () => {
                sidebar.classList.toggle('open');
                backdrop.classList.toggle('visible');
            });

            // Close the menu when clicking the backdrop
            backdrop.addEventListener('click', closeMenu);

            // Handle navigation and section visibility
            menuLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Remove active class from all links
                    menuLinks.forEach(l => l.classList.remove('active'));

                    // Add active class to the clicked link
                    link.classList.add('active');

                    // Hide all content sections
                    contentSections.forEach(section => section.classList.add('hidden'));

                    // Show the corresponding content section
                    const targetId = link.getAttribute('href').substring(1);
                    document.getElementById(targetId).classList.remove('hidden');

                    // If the "Livres sur la foi" link is clicked, load the books
                    if (targetId === 'livres-sur-la-foi') {
                        loadBooks();
                    }
                    
                    // If the "Autres Livres" link is clicked, load the other books
                    if (targetId === 'autres-livres') {
                        loadOtherBooks();
                    }
                    
                    // If the "Articles" link is clicked, load the articles
                    if (targetId === 'articles') {
                        loadArticles();
                    }

                    // Close the sidebar after navigation
                    closeMenu();
                });
            });

            // Handle initial state and URL hash navigation
            const initialHash = window.location.hash || '#accueil';
            const initialLink = document.querySelector(`.menu-link[href="${initialHash}"]`);
            if (initialLink) {
                initialLink.click();
            }
        });
    </script>
</body>
</html>